---
title: "The Evolving Cyber Threat Landscape"
subtitle: "A Decade in Review: Global Cybersecurity Threats 2015-2024"
author: "Patrick Lefler"
date: today
format:
  html:
    theme: slate
    css: style.css
    toc: true
    toc-depth: 3
    toc-location: left
    number-sections: true
    code-fold: true
    code-summary: "Show code"
    embed-resources: true
    page-layout: full
    fig-width: 10
    fig-height: 6
    df-print: paged
    link-external-newwindow: true
execute:
  warning: false
  message: false
  echo: false
---

```{r setup}
#| include: false

# Load required libraries
library(tidyverse)
library(conflicted)
library(plotly)
library(scales)
library(patchwork)
library(gt)
library(RColorBrewer)
library(lubridate)
library(gghighlight)
library(ggridges)

# Set theme for Plotly plots - Dark mode optimized
theme_set(theme_minimal(base_size = 9) +
  theme(
    plot.title = element_text(size = 12, color = "#ffffff"),
    plot.subtitle = element_text(size = 10.5, color = "#b8b8b8"),
    plot.caption = element_text(size = 9, color = "#888888"),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_line(color = "#444444"),
    legend.position = "bottom",
    plot.background = element_rect(fill = "#222222", color = NA),
    panel.background = element_rect(fill = "#222222", color = NA),
    legend.background = element_rect(fill = "#222222", color = NA),
    legend.text = element_text(color = "#ffffff"),
    legend.title = element_text(color = "#ffffff"),
    axis.text = element_text(color = "#b8b8b8"),
    axis.title = element_text(color = "#ffffff")
  ))

# Set plotly template for dark mode
plotly_template <- "plotly_dark"

# Custom color palette - adjusted for dark theme
threat_colors <- c(
  "DDoS" = "#0d3082",
  "Ransomware" = "#88dae7",
  "Phishing" = "#76cd65",
  "Malware" = "#ffc247",
  "SQL Injection" = "#ff8133",
  "Man-in-the-Middle" = "#eb5133"
)

industry_colors <- c(
  "Banking" = "#2ecc71",
  "Healthcare" = "#e74c3c",
  "Government" = "#3498db",
  "Education" = "#f39c12",
  "IT" = "#9b59b6",
  "Retail" = "#1abc9c",
  "Telecommunications" = "#e67e22"
)

### Set ggplot2 characteristics
ggplotLineSize = 1.0
ggplotPointSize = 2
ggplotTitleSize = 10
ggplotSubTitleSize = 9
ggplotSubTitleFont = "italic"


```

```{r load_data}
#| include: false

# Load the dataset
cyber_data <- read_csv("data/Global_Cybersecurity_Threats_2015-2024.csv")

# Data cleaning and preparation
cyber_data <- cyber_data %>%
  mutate(
    Year = as.integer(Year),
    `Financial Loss (in Million $)` = as.numeric(`Financial Loss (in Million $)`),
    `Number of Affected Users` = as.integer(`Number of Affected Users`),
    `Incident Resolution Time (in Hours)` = as.numeric(`Incident Resolution Time (in Hours)`)
  ) %>%
  rename(
    Financial_Loss = `Financial Loss (in Million $)`,
    Affected_Users = `Number of Affected Users`,
    Resolution_Time = `Incident Resolution Time (in Hours)`,
    Attack_Type = `Attack Type`,
    Target_Industry = `Target Industry`,
    Attack_Source = `Attack Source`,
    Vulnerability_Type = `Security Vulnerability Type`,
    Defense_Mechanism = `Defense Mechanism Used`
  )
```

::: {.callout-note icon=false}
## Executive Summary

Key Findings from 10 Years of Global Cybersecurity Data (2015-2024):

- **$155.7 billion** in total financial losses across `r format(nrow(cyber_data), big.mark=",")` documented incidents
- **DDoS and Ransomware attacks** dominate the threat landscape, accounting for 60% of all incidents
- **Healthcare, IT, and Banking sectors** face the highest financial exposure
- **Nation-state actors** increasingly target critical infrastructure with sophisticated zero-day exploits
- **AI-based detection systems** show 35% faster incident resolution times compared to traditional defenses
- **2024 emerging trend:** Zero-day vulnerabilities up 47% from 2023, signaling escalating sophistication

**Strategic Recommendation:** Organizations must prioritize proactive threat intelligence, accelerate patch management cycles, and invest in AI-driven security operations to counter the evolving threat landscape.
:::

## The Financial Impact of Cyber Threats

### Aggregate Losses by Year

```{r annual_losses}

#| fig-height: 5

annual_summary <- cyber_data %>%
  group_by(Year) %>%
  summarise(
    Total_Loss = sum(Financial_Loss, na.rm = TRUE),
    Incident_Count = n(),
    Avg_Loss = mean(Financial_Loss, na.rm = TRUE),
    Total_Users_Affected = sum(Affected_Users, na.rm = TRUE)
  ) %>%
  mutate(total.loss.billions = Total_Loss / 1000)

# Create vertical bar chart
p1 <- ggplot(annual_summary, aes(x = factor(Year), y = total.loss.billions)) +
  geom_col(fill = "#e74c3c", alpha = 0.9) +
  geom_text(aes(label = paste0("$", round(total.loss.billions, 3), "B")), 
            vjust = -1.0, color = "#ffffff", size = 3) +
  scale_y_continuous(labels = dollar_format(prefix = "$", suffix = "B"),
                    expand = expansion(mult = c(0, 0.15))) +
  labs(
    title = "Total Financial Losses Show Volatile but Persistent Threat",
    subtitle = "Annual aggregate losses from documented cyber incidents",
    x = NULL,
    y = "Total Financial Loss",
    caption = "Source: Global Cybersecurity Threat Database"
  )

ggplotly(p1, tooltip = c("y")) %>%
  plotly::layout(template = plotly_template)

```

&nbsp;

```{r incident_count_trend}

#| fig-height: 5

p2 <- ggplot(annual_summary, aes(x = Year)) +
  geom_col(aes(y = Incident_Count), fill = "#3498db", alpha = 0.7) +
  scale_y_continuous(
    name = "Documented Incidents / Year",
    sec.axis = sec_axis(~./10, name = "Avg Loss per Incident ($M)", 
                       labels = dollar_format(prefix = "$", suffix = "M"))
  ) +
  scale_x_continuous(breaks = 2015:2024) +
  labs(
    title = "Attack Frequency Remains High Despite Improved Defenses",
    subtitle = "Incident count (bars) vs. average loss per incident (line)",
    x = NULL, caption = "Note: Average loss scaled 10x for visualization"
  ) +
  theme(
    axis.title.y.left = element_text(color = "#3498db"),
    axis.title.y.right = element_text(color = "#e74c3c")
  )

ggplotly(p2, tooltip = c("y")) %>%
  plotly::layout(template = plotly_template)

```

### The Changing Face of Cyber Threats

```{r attack_type_trends}

#| fig-height: 5

attack_trends <- cyber_data %>%
  group_by(Year, Attack_Type) %>%
  summarise(
    Count = n(),
    Total_Loss = sum(Financial_Loss, na.rm = TRUE),
    .groups = "drop"
  )

# Get top 4 attack types by total count
top_attacks <- attack_trends %>%
  group_by(Attack_Type) %>%
  summarise(Total_Count = sum(Count)) %>%
  arrange(desc(Total_Count)) %>%
  head(4) %>%
  pull(Attack_Type)

# Filter to top 4 attack types
attack_trends_filtered <- attack_trends %>%
  dplyr::filter(Attack_Type %in% top_attacks)

# Attack type trends - cleaner version with top 4 only
p3 <- ggplot(attack_trends_filtered, aes(x = Year, y = Count, color = Attack_Type, group = Attack_Type)) +
  geom_line(size = ggplotLineSize, alpha = 0.9) +
  geom_point(size = ggplotPointSize, alpha = 0.9) +
  scale_color_manual(values = threat_colors[top_attacks]) +
  scale_x_continuous(breaks = 2015:2024) +
  labs(
    title = "Top Four Attack Types: DDoS and Phishing Lead the Threat Landscape",
    subtitle = "Incident count by attack type (2015-2024) - showing top 4 most common attacks",
    x = NULL,
    y = "Number of Incidents",
    color = "Attack Type"
  ) +
  theme(legend.position = "right")

ggplotly(p3, tooltip = c("y", "x")) %>%
  plotly::layout(template = plotly_template)


```

&nbsp;

```{r attack_type_proportion}

#| fig-height: 5

# Calculate total counts and percentages for each attack type
attack_distribution <- cyber_data %>%
  group_by(Attack_Type) %>%
  summarise(Count = n()) %>%
  mutate(
    Percentage = Count / sum(Count) * 100,
    Label = paste0(round(Percentage, 1), "%")
  ) %>%
  arrange(desc(Count))

p4 <- ggplot(attack_distribution, aes(x = Count, y = reorder(Attack_Type, Count), fill = Attack_Type)) +
  geom_col(show.legend = FALSE, alpha = 0.9) +
  geom_text(aes(label = paste0(Count, " (", Label, ")")), 
            hjust = -0.2, color = "#ffffff", size = 3) +
  scale_fill_manual(values = threat_colors) +
  scale_x_continuous(expand = expansion(mult = c(0, 0.15))) +
  labs(
    title = "DDoS Attacks Lead in Frequency Across All Incident Types",
    subtitle = "Total incident count and percentage by attack type (2015-2024)",
    x = "Number of Incidents 2015-2024",
    y = NULL
  )

ggplotly(p4, tooltip = c("y", "x")) %>%
  plotly::layout(template = plotly_template)

```

### Financial Impact by Attack Type

```{r attack_financial_impact}
#| fig-height: 5

attack_financial <- cyber_data %>%
  group_by(Attack_Type) %>%
  summarise(
    Total_Loss = sum(Financial_Loss, na.rm = TRUE),
    Avg_Loss = mean(Financial_Loss, na.rm = TRUE),
    Incidents = n(),
    Total_Users = sum(Affected_Users, na.rm = TRUE)
  ) %>%
  mutate(total.loss.billions = Total_Loss / 1000) %>%
  arrange(desc(total.loss.billions))

p5 <- ggplot(attack_financial, aes(x = reorder(Attack_Type, total.loss.billions), y = total.loss.billions, fill = Attack_Type)) +
  geom_col(show.legend = FALSE) +
  geom_text(aes(label = dollar(total.loss.billions, prefix = "$", suffix = "B")), 
            hjust = -0.1, size = 3, color = "#ffffff") +
  scale_fill_manual(values = threat_colors) +
  scale_y_continuous(labels = dollar_format(prefix = "$", suffix = "B"), 
                    expand = expansion(mult = c(0, 0.15))) +
  coord_flip() +
  labs(
    title = "DDoS Attacks Lead in Total Financial Damage",
    subtitle = "Cumulative losses by attack type (2015-2024)",
    x = NULL,
    y = "Cumulative Financial Loss"
  )

# ggplotly(p5, tooltip = c("y")) %>%
#   plotly::layout(template = plotly_template)

p5

```

## Industry Sector Analysis

### Financial Impact Heatmap

```{r industry_year_heatmap}
#| fig-cap: "Financial Loss Heatmap: Industry × Year"
#| fig-height: 7

industry_year <- cyber_data %>%
  group_by(Year, Target_Industry) %>%
  summarise(
    Total_Loss = sum(Financial_Loss, na.rm = TRUE),
    Incident_Count = n(),
    .groups = "drop"
  ) %>%
  mutate(total.loss.billions = Total_Loss / 1000)

p6 <- ggplot(industry_year, aes(x = factor(Year), y = Target_Industry, fill = total.loss.billions)) +
  geom_tile(color = "white", size = 0.5) +
  geom_text(aes(label = ifelse(total.loss.billions, 
                               paste0("$", round(total.loss.billions, 1), "B"),
                               "")), 
            color = "white", size = 3, fontface = "bold") +
  scale_fill_gradient2(
    low = "#3498db",
    mid = "#f39c12", 
    high = "#e74c3c",
    midpoint = median(industry_year$total.loss.billions),
    labels = dollar_format(prefix = "$", suffix = "B")
  ) +
  labs(
    title = "Healthcare and IT Face Consistently High Financial Exposure",
    subtitle = "Total financial losses by industry and year",
    x = NULL,
    y = NULL,
    fill = "Total Loss"
  ) +
  theme(
    axis.text.x = element_text(angle = 0),
    panel.grid = element_blank()
  )

p6
```

### Most Targeted Industries

```{r industry_ranking}

industry_summary <- cyber_data %>%
  group_by(Target_Industry) %>%
  summarise(
    Total_Loss = sum(Financial_Loss, na.rm = TRUE),
    Incidents = n(),
    Avg_Loss = mean(Financial_Loss, na.rm = TRUE),
    Total_Users = sum(Affected_Users, na.rm = TRUE),
    Avg_Resolution = mean(Resolution_Time, na.rm = TRUE)
  ) %>%
  mutate(total.loss.billions = Total_Loss / 1000) %>%
  mutate(total.users.millions = Total_Users / 1000000) %>%
  arrange(desc(total.loss.billions)) %>%
  select(-Total_Loss, -Total_Users) %>%
  relocate(Target_Industry, Incidents, total.loss.billions)

# Create professional table
industry_summary %>%
  mutate(
    total.loss.billions = dollar(total.loss.billions, prefix = "$", suffix = "B", accuracy = 0.01),
    Avg_Loss = dollar(Avg_Loss, prefix = "$", suffix = "M", accuracy = 0.01),
    total.users.millions = number(total.users.millions, suffix = "M", accuracy = 0.01),
    Avg_Resolution = paste0(round(Avg_Resolution, 1), " hrs")
  ) %>%
  gt() %>%
  tab_header(
    title = "Industry Risk Profile",
    subtitle = "Cumulative metrics by target industry (2015-2024)"
  ) %>%
  cols_label(
    Target_Industry = "Industry",
    total.loss.billions = "Cumulative Loss",
    Incidents = "Incidents",
    Avg_Loss = "Avg Loss/Incident",
    total.users.millions = "Users Affected",
    Avg_Resolution = "Avg Resolution"
  ) %>%
  tab_style(
    style = cell_fill(color = "#e74c3c", alpha = 0.3),
    locations = cells_body(rows = 1:3)
  ) %>%
  tab_style(
    style = cell_text(weight = "bold"),
    locations = cells_body(columns = Target_Industry)
  ) %>%
  opt_row_striping()

```

## Geographic Threat Distribution

```{r geographic_analysis}
#| fig-height: 5

country_summary <- cyber_data %>%
  group_by(Country) %>%
  summarise(
    Total_Loss = sum(Financial_Loss, na.rm = TRUE),
    Incidents = n(),
    Avg_Loss = mean(Financial_Loss, na.rm = TRUE),
    Total_Users = sum(Affected_Users, na.rm = TRUE)
  ) %>%
  mutate("total.loss" = Total_Loss / 1000) %>%
  select(-Total_Loss) %>%
  arrange(desc(total.loss))

p7 <- ggplot(country_summary, aes(x = Incidents, y = total.loss, 
                                   size = Total_Users, color = Country)) +
  geom_point(alpha = 0.7) +
  scale_size_continuous(range = c(4, 16), labels = number_format(big.mark = ",")) +
  scale_y_continuous(labels = dollar_format(prefix = "$", suffix = "B")) +
  scale_color_brewer(palette = "Set3") +
  labs(
    title = "Geographic Risk Matrix: Incident Frequency vs. Financial Impact",
    subtitle = "2015-2024: Bubble size represents total users affected",
    x = "Number of Incidents",
    y = "Cumulative Financial Loss (2015-2024)",
    size = "Users Affected",
    color = "Country"
  ) +
  theme(legend.position = "right")

ggplotly(p7, tooltip = c("x", "y", "colour", "size")) %>%
  plotly::layout(template = plotly_template)
```


## Attack Sophistication Index

### Vulnerability Type Analysis

```{r vulnerability_analysis}

#| fig-height: 5

vuln_trends <- cyber_data %>%
  group_by(Year, Vulnerability_Type) %>%
  summarise(
    Count = n(),
    Total_Loss = sum(Financial_Loss, na.rm = TRUE),
    .groups = "drop"
  )

p9 <- ggplot(vuln_trends, aes(x = Year, y = Count, fill = Vulnerability_Type)) +
  geom_area(position = "fill", alpha = 0.8) +
  scale_fill_brewer(palette = "Set2") +
  scale_y_continuous(labels = percent_format()) +
  scale_x_continuous(breaks = 2015:2024) +
  labs(
    title = "Zero-Day Exploits Show Concerning Growth Trajectory",
    subtitle = "Vulnerability type distribution over time",
    x = NULL,
    y = "Percentage of Incidents",
    fill = "Vulnerability Type"
  )

p9


```

&nbsp;

```{r sophistication_index}

#| fig-height: 5

vuln_comparison <- cyber_data %>%
  mutate(
    Sophistication = case_when(
      Vulnerability_Type == "Zero-day" ~ "High Sophistication",
      Vulnerability_Type %in% c("Weak Passwords", "Social Engineering") ~ "Low Sophistication",
      TRUE ~ "Medium Sophistication"
    )
  ) %>%
  group_by(Year, Sophistication) %>%
  summarise(
    Count = n(),
    Avg_Loss = mean(Financial_Loss, na.rm = TRUE),
    .groups = "drop"
  )

p10 <- ggplot(vuln_comparison, aes(x = Year, y = Count, color = Sophistication, group = Sophistication)) +
  geom_line(size = ggplotLineSize) +
  geom_point(size = ggplotPointSize) +
  scale_color_manual(values = c(
    "High Sophistication" = "#c0392b",
    "Medium Sophistication" = "#f39c12",
    "Low Sophistication" = "#27ae60"
  )) +
  scale_x_continuous(breaks = 2015:2024) +
  labs(
    title = "High-Sophistication Attacks Increasing Despite Better Defenses",
    subtitle = "Attack categorization by exploit sophistication level",
    x = NULL,
    y = "Number of Incidents",
    color = "Attack Sophistication"
  )

ggplotly(p10, tooltip = c("x", "y")) %>%
  plotly::layout(template = plotly_template)

```

### Attack Source Analysis

```{r attack_source_analysis}

#| fig-height: 5

source_trends <- cyber_data %>%
  group_by(Year, Attack_Source) %>%
  summarise(
    Count = n(),
    Total_Loss = sum(Financial_Loss, na.rm = TRUE),
    .groups = "drop"
  )

p11 <- ggplot(source_trends, aes(x = Year, y = Count, color = Attack_Source)) +
  geom_line(size = ggplotLineSize) +
  geom_point(size = ggplotPointSize) +
  scale_color_manual(values = c(
    "Nation-state" = "#c0392b",
    "Hacker Group" = "#e67e22",
    "Insider" = "#9b59b6",
    "Unknown" = "#95a5a6"
  )) +
  scale_x_continuous(breaks = 2015:2024) +
  labs(
    title = "Nation-State Attacks Show Persistent and Growing Threat",
    subtitle = "Incident attribution by actor type",
    x = NULL,
    y = "Number of Incidents",
    color = "Attack Source"
  )

ggplotly(p11, tooltip = c("x", "y")) %>%
  plotly::layout(template = plotly_template)

```

## Incident Response Effectiveness

### Resolution Time Analysis

```{r resolution_time_trends}

#| fig-height: 5

resolution_trends <- cyber_data %>%
  group_by(Year) %>%
  summarise(
    Avg_Resolution = mean(Resolution_Time, na.rm = TRUE),
    Median_Resolution = median(Resolution_Time, na.rm = TRUE),
    Q25 = quantile(Resolution_Time, 0.25, na.rm = TRUE),
    Q75 = quantile(Resolution_Time, 0.75, na.rm = TRUE)
  )

p12 <- ggplot(resolution_trends, aes(x = Year)) +
  geom_ribbon(aes(ymin = Q25, ymax = Q75), fill = "#3498db", alpha = 0.3) +
  geom_line(aes(y = Median_Resolution, color = "Median"), size = ggplotLineSize) +
  geom_line(aes(y = Avg_Resolution, color = "Average"), size = ggplotLineSize, linetype = "dashed") +
  geom_point(aes(y = Median_Resolution), color = "#2980b9", size = ggplotPointSize) +
  scale_color_manual(values = c("Median" = "#2980b9", "Average" = "#e74c3c")) +
  scale_x_continuous(breaks = 2015:2024) +
  scale_y_continuous(labels = function(x) paste0(x, " hrs")) +
  labs(
    title = "Response Times Show Modest Improvement Over Decade",
    subtitle = "Shaded area represents 25th-75th percentile range",
    x = NULL,
    y = "Resolution Time (Hours)",
    color = "Metric"
  )

ggplotly(p12, tooltip = c("x", "y")) %>%
  plotly::layout(template = plotly_template)
```

### Defense Mechanism Effectiveness

```{r defense_effectiveness}


defense_analysis <- cyber_data %>%
  group_by(Defense_Mechanism) %>%
  summarise(
    Incidents = n(),
    Avg_Resolution = mean(Resolution_Time, na.rm = TRUE),
    Avg_Loss = mean(Financial_Loss, na.rm = TRUE),
    Success_Rate = 100 - (Avg_Loss / max(Avg_Loss) * 100)
  ) %>%
  arrange(Avg_Resolution)

p13 <- ggplot(defense_analysis, aes(x = Avg_Resolution, y = Avg_Loss, 
                                     size = Incidents, color = Defense_Mechanism)) +
  geom_point(alpha = 0.8) +
  scale_size_continuous(range = c(4, 16)) +
  scale_color_brewer(palette = "Set2") +
  scale_x_continuous(labels = function(x) paste0(x, " hrs")) +
  scale_y_continuous(labels = dollar_format(prefix = "$", suffix = "M")) +
  labs(
    title = "AI-Based Detection Outperforms Traditional Defense Mechanisms",
    subtitle = "Resolution time vs. average financial loss (bubble size = incident count)",
    x = "Average Resolution Time",
    y = "Average Loss per Incident",
    size = "Incidents",
    color = "Defense Type"
  ) +
  theme(legend.position = "right")

ggplotly(p13, tooltip = c("x", "y", "size", "colour")) %>%
  plotly::layout(template = plotly_template)
```


## 2024 Emerging Trends

```{r recent_trends}


recent_data <- cyber_data %>%
  dplyr::filter(Year %in% c(2023, 2024)) %>%
  group_by(Year, Attack_Type) %>%
  summarise(
    Count = n(),
    Total_Loss = sum(Financial_Loss, na.rm = TRUE),
    .groups = "drop"
  ) %>%
  pivot_wider(names_from = Year, values_from = c(Count, Total_Loss), values_fill = 0) %>%
  mutate(
    Count_Change = ((Count_2024 - Count_2023) / Count_2023 * 100),
    Loss_Change = ((Total_Loss_2024 - Total_Loss_2023) / Total_Loss_2023 * 100)
  )

p14 <- ggplot(recent_data, aes(x = reorder(Attack_Type, Count_Change), y = Count_Change, fill = Attack_Type)) +
  geom_col(show.legend = FALSE) +
  geom_hline(yintercept = 0, linetype = "dashed", color = "gray50") +
  geom_text(aes(label = paste0(ifelse(Count_Change > 0, "+", ""), round(Count_Change, 1), "%")),
            hjust = ifelse(recent_data$Count_Change > 0, -0.2, 1.2), size = 3, colour = "white") +
  scale_fill_manual(values = threat_colors) +
  scale_y_continuous(labels = percent_format(scale = 1), 
                    expand = expansion(mult = c(0.15, 0.15))) +
  coord_flip() +
  labs(
    title = "Year-over-Year Attack Trend Analysis (2023 → 2024)",
    subtitle = "Percentage change in incident frequency",
    x = NULL,
    y = "Change in Incident Count (%)"
  )

p14

```

## Methodology & Data Notes

**Data Source:** Global Cybersecurity Threat Database covering 3,001 documented incidents across 12 countries from 2015-2024.

**Coverage:** This analysis includes reported incidents from major economies (USA, China, India, UK, Germany, France, Russia, Japan, Brazil, Australia) across seven key industry sectors.

**Limitations:** This dataset represents documented and reported incidents. Actual incident volumes may be significantly higher due to underreporting, particularly in sectors with limited disclosure requirements.

**Analysis Approach:** Descriptive statistics, time series analysis, and comparative trend analysis using R statistical computing environment.

---

::: {.callout-tip icon=false}

### About This Report

This report utilizes the Global Cybersecurity Threats Dataset (2015-2024) that provides extensive data on cyberattacks, malware types, targeted industries, and affected countries. It is designed for threat intelligence analysis, cybersecurity trend forecasting, and machine learning model development to enhance global digital security.

This report was developed using R Quarto for reproducible analytics. All visualizations were created using the R ggplot2 and plotly packages.

:::

```{r session_info}
#| include: false
sessionInfo()
```
